
-- =============================================
-- This stored procedure is generated by BuildProject
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_Update
		@FK_sMaSV	varchar(50)
		,@FK_sMaMonhoc	varchar(50)
		,@PK_iSolanhoc	smallint
		,@fDiemchuyencan	float
		,@fDiemgiuaky	float
		,@fDiemthilan1	float
		,@fDiemthilan2	float
		,@iTrangThai	smallint
AS
BEGIN
	SET NOCOUNT ON;
		
	UPDATE [tblDiemThi]	SET
		 [fDiemchuyencan] 	= @fDiemchuyencan
		,[fDiemgiuaky] 	= @fDiemgiuaky
		,[fDiemthilan1] 	= @fDiemthilan1
		,[fDiemthilan2] 	= @fDiemthilan2
		,[iTrangThai] 	= @iTrangThai
	WHERE 
		[FK_sMaSV] 	= @FK_sMaSV
		AND [FK_sMaMonhoc] 	= @FK_sMaMonhoc
		AND [PK_iSolanhoc] 	= @PK_iSolanhoc
		
END

GO

-- =============================================
-- This stored procedure is generated by BuildProject 
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_Delete
		@FK_sMaSV	varchar(50)
		,@FK_sMaMonhoc	varchar(50)
		,@PK_iSolanhoc	smallint
AS
BEGIN
	SET NOCOUNT ON;
		
	Delete [tblDiemThi]
	Where
		[FK_sMaSV] 	= @FK_sMaSV
		AND [FK_sMaMonhoc] 	= @FK_sMaMonhoc
		AND [PK_iSolanhoc] 	= @PK_iSolanhoc
		
END

GO

-- =============================================
-- This stored procedure is generated by BuildProject
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_Insert
			@FK_sMaSV	varchar(50)
			,@FK_sMaMonhoc	varchar(50)
			,@PK_iSolanhoc	smallint
			,@fDiemchuyencan	float
			,@fDiemgiuaky	float
			,@fDiemthilan1	float
			,@fDiemthilan2	float
			,@iTrangThai	smallint
AS
BEGIN
	SET NOCOUNT ON;
		
	Insert Into [tblDiemThi]( [FK_sMaSV]
				,[FK_sMaMonhoc]
				,[PK_iSolanhoc]
				,[fDiemchuyencan]
				,[fDiemgiuaky]
				,[fDiemthilan1]
				,[fDiemthilan2]
				,[iTrangThai]
				)
		
	Values	( @FK_sMaSV
				,@FK_sMaMonhoc
				,@PK_iSolanhoc
				,@fDiemchuyencan
				,@fDiemgiuaky
				,@fDiemthilan1
				,@fDiemthilan2
				,@iTrangThai
				)

END

GO

-- =============================================
-- This stored procedure is generated by BuildProject
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_SelectItem
		@FK_sMaSV	varchar(50)
		,@FK_sMaMonhoc	varchar(50)
		,@PK_iSolanhoc	smallint
AS
BEGIN
	SET NOCOUNT ON;
		
	Select 		[FK_sMaSV]
				, [FK_sMaMonhoc]
				, [PK_iSolanhoc]
				, [fDiemchuyencan]
				, [fDiemgiuaky]
				, [fDiemthilan1]
				, [fDiemthilan2]
				, [iTrangThai]
	From	[tblDiemThi]
	Where
		[FK_sMaSV] 	= @FK_sMaSV
		AND [FK_sMaMonhoc] 	= @FK_sMaMonhoc
		AND [PK_iSolanhoc] 	= @PK_iSolanhoc
		
END

GO

-- =============================================
-- This stored procedure is generated by BuildProject
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_SelectList
AS
BEGIN
	SET NOCOUNT ON;
		
	Select 		[FK_sMaSV]
				, [FK_sMaMonhoc]
				, [PK_iSolanhoc]
				, [fDiemchuyencan]
				, [fDiemgiuaky]
				, [fDiemthilan1]
				, [fDiemthilan2]
				, [iTrangThai]
	From	[tblDiemThi]
	Order by [FK_sMaSV], [FK_sMaMonhoc], [PK_iSolanhoc]
		
END

GO

-- =============================================
-- This stored procedure is generated by BuildProject
-- Author:	ThangNM
-- Create date:	16/03/2014 16:44
-- Description:	
-- Revise History:	
-- =============================================
CREATE PROCEDURE tblDiemThi_Search
			@FK_sMaSV	varchar(50)
			,@FK_sMaMonhoc	varchar(50)
			,@PK_iSolanhoc	smallint
			,@fDiemchuyencan	float
			,@fDiemgiuaky	float
			,@fDiemthilan1	float
			,@fDiemthilan2	float
			,@iTrangThai	smallint
AS
BEGIN
	SET NOCOUNT ON;
		
	Select 		[FK_sMaSV]
				, [FK_sMaMonhoc]
				, [PK_iSolanhoc]
				, [fDiemchuyencan]
				, [fDiemgiuaky]
				, [fDiemthilan1]
				, [fDiemthilan2]
				, [iTrangThai]
	From	[tblDiemThi]
	Where
		(@FK_sMaSV is null or [FK_sMaSV] 	like '%' + @FK_sMaSV+ '%')
		AND (@FK_sMaMonhoc is null or [FK_sMaMonhoc] 	like '%' + @FK_sMaMonhoc+ '%')
		AND (@PK_iSolanhoc is null or [PK_iSolanhoc] 	like '%' + @PK_iSolanhoc+ '%')
		AND (@fDiemchuyencan is null or [fDiemchuyencan] 	like '%' + @fDiemchuyencan+ '%')
		AND (@fDiemgiuaky is null or [fDiemgiuaky] 	like '%' + @fDiemgiuaky+ '%')
		AND (@fDiemthilan1 is null or [fDiemthilan1] 	like '%' + @fDiemthilan1+ '%')
		AND (@fDiemthilan2 is null or [fDiemthilan2] 	like '%' + @fDiemthilan2+ '%')
		AND (@iTrangThai is null or [iTrangThai] 	like '%' + @iTrangThai+ '%')
		
END

GO

	
CREATE PROCEDURE tblDiemThi_SelectByFK_sMaSV
		@FK_sMaSV	varchar
AS
BEGIN
	SET NOCOUNT ON;

	Select 		[FK_sMaSV]
				, [FK_sMaMonhoc]
				, [PK_iSolanhoc]
				, [fDiemchuyencan]
				, [fDiemgiuaky]
				, [fDiemthilan1]
				, [fDiemthilan2]
				, [iTrangThai]
	From	[tblDiemThi]
	Where	FK_sMaSV	= @FK_sMaSV
END

GO
	
CREATE PROCEDURE tblDiemThi_SelectByFK_sMaMonhoc
		@FK_sMaMonhoc	varchar
AS
BEGIN
	SET NOCOUNT ON;

	Select 		[FK_sMaSV]
				, [FK_sMaMonhoc]
				, [PK_iSolanhoc]
				, [fDiemchuyencan]
				, [fDiemgiuaky]
				, [fDiemthilan1]
				, [fDiemthilan2]
				, [iTrangThai]
	From	[tblDiemThi]
	Where	FK_sMaMonhoc	= @FK_sMaMonhoc
END

GO
	